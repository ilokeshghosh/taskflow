<mvc:View
    xmlns:statusindicator="sap.suite.ui.commons.statusindicator"
    xmlns:f="sap.f"
    xmlns:layout="sap.ui.layout"
    controllerName="com.taskflow.dev.frontend.controller.Home"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:tnt="sap.tnt"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core"
    xmlns:custom="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
>
    <!-- xmlns:custom="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"  is used to add Custom data for navigation (using custom:to="pageID") used in master page navigation item list -->

    <!-- SplitApp Container -->
    <SplitApp
        id="taskflowLadingPage"
        initialDetail="detail"
        initialMaster="master"
    >
        <!-- SplitApp Master Pages || Left Side || Main Navigation-->
        <masterPages>
            <!-- Main Master Page with list of navigation items -->
            <Page
                id="master"
                title="TaskFlow"
                backgroundDesign="List"
                showFooter="true"
            >
                <!-- navigation items list -->
                <List itemPress=".onNavItemPress">
                    <items>
                        <!-- Home Page Navigation Item with custom data -->
                        <StandardListItem
                            title="Home"
                            type="Active"
                            custom:to="home"
                            icon="sap-icon://home"
                        />

                        <!-- Projects Page Navigation Item(all project on right detailed page) with custom data -->
                        <StandardListItem
                            title="Projects"
                            type="Active"
                            custom:to="project"
                            icon="sap-icon://newspaper"
                        />

                        <!-- Tasks Page Navigation Item(with all tasks on right detailed page) with custom data -->
                        <StandardListItem
                            title="Tasks"
                            type="Active"
                            custom:to="tasks"
                            icon="sap-icon://task"
                        />

                        <!-- TO BE IMPLEMENTED -->
                        <!-- Kanban Desk Navigation Item -->
                        <StandardListItem
                            title="Kanban Desk"
                            type="Active"
                            custom:to="kanbanDesk"
                            icon="sap-icon://grid"
                        />

                        <!-- TO BE IMPLEMENTED -->
                        <!-- Calender Navigation for Projects/Task Deadline -->
                        <StandardListItem
                            title="Calender"
                            type="Active"
                            custom:to="calender"
                            icon="sap-icon://appointment-2"
                        />

                        <!-- Projects Navigation Items ( will navigate to Master Page with all project List on left side and project details on right side) -->
                        <StandardListItem
                            title="Projects"
                            type="Navigation"
                            press=".onPressGoToProjectsMaster"
                            icon="sap-icon://business-objects-mobile"
                            custom:to="projectNav"
                        />
                    </items>
                </List>
                <!-- Footer Container for create projects/tasks, notification and user profile -->
                <footer>
                    <Toolbar height="auto">
                        <List>
                            <!-- create Task List Item to open create task dialog -->
                            <StandardListItem
                                icon="sap-icon://add-activity"
                                type="Active"
                                title="Create Task"
                                press="handleOpenCreateTaskDialog"
                                visible="{= ${currentUser>/roles/0}==='manager' || ${currentUser>/roles/0}==='member'}"
                            />

                            <!-- create Project List Item to open create project dialog -->
                            <StandardListItem
                                icon="sap-icon://add"
                                iconInset="true"
                                type="Active"
                                title="Create Project"
                                press="handleOpenCreateProjectDialog"
                                visible="{= ${currentUser>/roles/0}==='manager' }"
                            />

                            <!-- TO BE IMPLEMENTED -->
                            <!-- Notification List item to open notifaction dialog to check notifications/alerts/updates -->
                            <StandardListItem
                                icon="sap-icon://bell"
                                iconInset="true"
                                type="Active"
                                title="Notifications"
                                press="onHandleNotification"
                            />

                            <!-- TO BE IMPLEMENTED || NEED TO UPDATED || NEEDS TO MAKE DYNAMIC(MUST COMPLY WITH GITHUB REPO VERSION) -->
                            <StandardListItem
                                class="sapUiTinyMarginBottom"
                                title="{currentUser>/firstname} {currentUser>/lastname}"
                                info="{= 'V' + ${/SystemInfo('SYSTEM')/version}}"
                                infoState="Information"
                                infoStateInverted="true"
                                description="{currentUser>/email}"
                                
                            >
                                <avatar>
                                    <!-- TO BE IMPLEMENTED || NEED TO UPDATED || NEED TO MAKE DYNAMIC AS PER USER AVATAR  -->
                                    <Avatar
                                        press="onAvatarPress"
                                        showBorder="true"
                                        displayShape="Circle"
                                        src="{currentUser>/avatarUrl}"
                                    >
                                    <detailBox>
                                    </detailBox>
                                    </Avatar>
                                </avatar>
                            </StandardListItem>
                        </List>
                    </Toolbar>
                </footer>
            </Page>

            <Page
                id="projects"
                title="Projects"
                backgroundDesign="List"
                showNavButton="true"
                navButtonPress=".onPressMasterBack"
            >
                <List
                    id="navItems"
                    itemPress=".onListItemPress"
                    items="{
                    path:'/Projects',
                    parameters:{
                            $expand:{
                                members:{
                                    $count:true,
                                    $expand:{
                                        user:true
                                    }
                                },
                                client:true,
                                tasks:{
                                    $count:true
                                },
                                manager:true
                            }
                        }
                    }"
                    mode="SingleSelectMaster"
                >
                    <items>
                        <StandardListItem
                            title="{name}"
                            type="Active"
                            info="{priority}"
                            infoState="{path:'priority',formatter:'.formatter.formatPriority'}"
                            infoStateInverted="true"
                            description="{status}"
                            custom:to="detail"
                        />
                    </items>
                </List>
            </Page>
        </masterPages>

        <!-- SplitApp Detail Pages || Right Side || Object Page-->
        <detailPages>
            <!-- Home Detail Page  -->
            <Page
                id="home"
                showHeader="true"
                title="Home"
                backgroundDesign="Solid"
            >
                <!-- Loading home fragment -->
                <core:Fragment
                    fragmentName="com.taskflow.dev.frontend.view.fragments.home"
                    type="XML"
                />
            </Page>

            <!-- Project Detail page -->
            <Page
                id="project"
                backgroundDesign="Solid"
                showHeader="true"
                title="Projects"
            >
                <!-- Loading projects fragment || showing all projects in a single page -->
                <core:Fragment
                    fragmentName="com.taskflow.dev.frontend.view.fragments.projects"
                    type="XML"
                />
            </Page>

            <!-- Task Detail Page -->
            <Page
                id="tasks"
                backgroundDesign="Solid"
                showHeader="true"
                title="Tasks"
            >
                <!-- Loading tasks || showing all tasks in a single page (not project specific) -->
                <core:Fragment
                    fragmentName="com.taskflow.dev.frontend.view.fragments.tasks"
                    type="XML"
                />
            </Page>

            <!-- Project Object Detail page || For selected project (non-dialog) -->
            <Page
                id="projectObject"
                backgroundDesign="Solid"
                showHeader="true"
                title="Project Details"
                class="projectObject"
            >
                <!-- Main Container -->
                <VBox
                    justifyContent="Center"
                    alignItems="Center"
                    width="100%"
                    height="auto"
                >
                    <!-- TOP CONTAINER ||  project overview(title & desc) details with progress, budget, team, tasks -->
                    <VBox
                        width="90%"
                        class="projectObjectBox sapUiTinyMarginTop"
                        gap="1rem"
                        height="auto"
                    >
                        <!-- TOP SECTION || Project Overview List Item (title, desc, status, priority) -->
                        <StandardListItem
                            title="{selectedProject>/name}"
                            description="{selectedProject>/description}"
                            info="{selectedProject>/status}"
                            infoState="{path:'selectedProject>/status',formatter:'.formatter.formatStatus'}"
                            infoStateInverted="true"
                            highlight="{path:'selectedProject>/priority',formatter:'.formatter.formatPriority'}"
                            wrapping="true"
                        />

                        <!-- LOWER SECTION CONTAINER || CARDS || Progress, Budget, Team, Tasks || WRAP ON -->
                        <FlexBox
                            height="auto"
                            wrap="Wrap"
                            gap="1rem"
                            width="100%"
                            alignItems="Center"
                            class="projectObjectBoxUpperContent"
                        >
                            <!-- Project Progress Card -->
                            <VBox
                                gap="0.3rem"
                                class="projectDetailsCard"
                                width="364px"
                            >
                                <!-- Title -->
                                <Title text="Progress" />
                                <!-- Inner Progress Card section -->
                                <VBox
                                    class="progressSection "
                                    justifyContent="End"
                                >
                                    <!-- Upper Section for percentage and task count -->
                                    <HBox
                                        justifyContent="SpaceBetween"
                                        alignItems="Center"
                                        class=""
                                    >
                                        <Text
                                            text="{selectedProject>/progress}%"
                                            class="progressLabel"
                                        />
                                        <Text
                                            text="{selectedProject>/tasks@odata.count} Tasks"
                                            class="progressValue"
                                        />
                                    </HBox>

                                    <!-- Progress Indicator -->
                                    <ProgressIndicator
                                        percentValue="{selectedProject>/progress}"
                                        class="progressBar"
                                        width="100%"
                                        displayAnimation="true"
                                        displayOnly="true"
                                    />
                                </VBox>
                            </VBox>

                            <!-- Project Budget Card -->
                            <VBox
                                gap="0.3rem"
                                class="projectDetailsCard"
                                width="364px"
                            >
                                <!-- Budget Title -->
                                <Title
                                    width="100%"
                                    text="Budget"
                                />
                                <!-- Budget Number & Client Name -->
                                <Title text="${selectedProject>/budget}" />
                                <Text
                                    text="{selectedProject>/client/firstname} {selectedProject>/client/lastname}"
                                />
                            </VBox>

                            <!-- Project Team Card -->
                            <VBox
                                gap="0.3rem"
                                class="projectDetailsCard"
                                width="364px"
                            >
                                <!-- Team Title -->
                                <Title
                                    width="100%"
                                    text="Team"
                                />
                                <!-- TO BE IMPLEMENTED || Avatar Group Container || Need to add all users avatar related to this project-->
                                <f:AvatarGroup
                                    groupType="Group"
                                    avatarDisplaySize="XS"
                                    items="{selectedProject>/members}"
                                >
                                    <f:items>
                                        <f:AvatarGroupItem
                                            src="{selectedProject>user/avatarUrl}"
                                            initials="asdf"
                                            tooltip="{selectedProject>user/firstname} {selectedProject>user/lastname}"
                                        >
                                        
                                        </f:AvatarGroupItem>
                                    </f:items>
                                </f:AvatarGroup>

                                <!-- TO BE IMPLEMENTED || Team Member Count || Need to add the number of user assigned to this project -->
                                <Text
                                    text="{selectedProject>/members@odata.count} Members"
                                />
                            </VBox>

                            <!-- Project Tasks Card -->
                            <VBox
                                gap="0.3rem"
                                class="projectDetailsCard"
                                width="364px"
                            >
                                <!-- Task Title-->
                                <Title
                                    width="100%"
                                    text="Tasks"
                                />

                                <!-- TO BE IMPLEMENTED || Task Count & updated at Details || Add the count of tasks and time of latest added/upated task-->
                                <Title
                                    text="{selectedProject>/tasks@odata.count}"
                                />
                                <Text
                                    text="{
                                    path: 'selectedProject>/modifiedAt',
                                    formatter: '.formatter.formatLastUpdated'
                                }"
                                />
                            </VBox>
                        </FlexBox>
                    </VBox>

                    <!-- LOWER CONTAINER || Icon Tab bar Container for Detailed Overview, Tasks, Teams, Discussions & Anaytics pages -->
                    <HBox
                        class="sapUiTinyMarginTop projectDetailsIconTab"
                        width="90%"
                    >
                        <!-- Icon Tab Bar Container -->
                        <IconTabBar select=".onFilterSelect" class="">
                            <items>
                                <!-- Project Overview Details Container -->
                                <IconTabFilter
                                    text="Overview"
                                    icon="sap-icon://document-text"
                                    design="Vertical"
                                    class=""
                                >
                                    <!-- Outer continer -->
                                    <HBox
                                        wrap="Wrap"
                                        width="100%"
                                        class="iconTabBarProjectOverview"
                                        justifyContent="SpaceBetween"
                                        gap="1rem"
                                    >
                                        <!-- LEFT || Project Description, Goals, Deliverables Container-->
                                        <VBox
                                            class="iconTabBarProjectOverviewContent"
                                            width="60%"
                                            height="auto"
                                            gap="1rem"
                                        >
                                            <!-- UPPER SECTION || Project Name -->
                                            <HBox>
                                                <VBox>
                                                    <Title
                                                        text="Project Description"
                                                        level="H1"
                                                    />
                                                    <Text
                                                        text="{selectedProject>/name}"
                                                    />
                                                </VBox>
                                            </HBox>

                                            <!-- MIDDLE SECTION || Project Description -->
                                            <HBox
                                                wrap="Wrap"
                                                width="90%"
                                            >
                                                <Title
                                                    text="{selectedProject>/description}"
                                                    wrapping="true"
                                                    level="H6"
                                                />
                                            </HBox>

                                            <!-- LOWER SECTION || Project Goals & Key Deliverables -->
                                            <HBox
                                                gap="1rem"
                                                wrap="Wrap"
                                                width="100%"
                                                visible="false"
                                            >
                                                <!-- TO BE IMPLEMENTED || Project Goals List -->
                                                <List
                                                    backgroundDesign="Transparent"
                                                    headerText="Project Goals"
                                                    class="projectGoals"
                                                >
                                                    <StandardListItem
                                                        title="Goal 1"
                                                    />

                                                    <StandardListItem
                                                        title="Goal 2"
                                                    />

                                                    <StandardListItem
                                                        title="Goal 3"
                                                    />

                                                    <StandardListItem
                                                        title="Goal 4"
                                                    />
                                                </List>

                                                <!-- TO BE IMPLEMENTED || Project key Deliverables List -->
                                                <List
                                                    backgroundDesign="Transparent"
                                                    class="projectGoals"
                                                    headerText="Key Deliverables"
                                                >
                                                    <StandardListItem
                                                        title="Deliverables 1"
                                                    />

                                                    <StandardListItem
                                                        title="Deliverables 2"
                                                    />

                                                    <StandardListItem
                                                        title="Deliverables 3"
                                                    />

                                                    <StandardListItem
                                                        title="Deliverables 4"
                                                    />
                                                </List>
                                            </HBox>
                                        </VBox>

                                        <!-- RIGHT || Project Details (Client, Budget, Start date, deadline, Project Manager) -->
                                        <VBox
                                            class="iconTabBarProjectOverviewContent projectDetails"
                                            width="35%"
                                            gap="1rem"
                                        >
                                            <!-- Project Details -->
                                            <Title text="Project Details" />

                                            <!-- Client Name -->
                                            <VBox>
                                                <Text text="Client" />
                                                <Title
                                                    text="{selectedProject>/client/firstname} {selectedProject>/client/lastname}"
                                                />
                                            </VBox>

                                            <!-- Budgets -->
                                            <VBox>
                                                <Text text="Budget" />
                                                <Title
                                                    text="{selectedProject>/budget}"
                                                />
                                            </VBox>

                                            <!-- Start Date -->
                                            <VBox>
                                                <Text text="Start Date" />
                                                <Title
                                                    text="{selectedProject>/startDate}"
                                                />
                                            </VBox>

                                            <!-- Deadline -->
                                            <VBox>
                                                <Text text="Deadline" />
                                                <Title
                                                    text="{selectedProject>/deadline}"
                                                />
                                            </VBox>

                                            <!-- TO BE IMPLEMENTED || Project Manager -->
                                            <VBox>
                                                <Text text="Project Manager" />
                                                <Title
                                                    text="{selectedProject>/manager/firstname} {selectedProject>/manager/lastname}"
                                                />
                                            </VBox>
                                        </VBox>
                                    </HBox>
                                </IconTabFilter>

                                <!-- Tasks Container-->
                                <IconTabFilter
                                    text="Tasks"
                                    icon="sap-icon://activities"
                                    design="Vertical"
                                >
                                    <!-- Loading Project Tasks Fragment (Non-dialog Fragment) -->
                                    <HBox>
                                        <core:Fragment
                                            id="projectTasksNonDialog"
                                            fragmentName="com.taskflow.dev.frontend.view.fragments.projects.projectTasks"
                                            type="XML"
                                        />
                                    </HBox>
                                </IconTabFilter>

                                <!-- Team Container -->
                                <IconTabFilter
                                    text="Team"
                                    icon="sap-icon://group"
                                    design="Vertical"
                                >
                                    <!-- Outter Container -->
                                    <HBox
                                        class="teamDetailsBox"
                                        width="100%"
                                    >
                                        <!-- TO BE IMPLEMENTED || Table for Team Details -->
                                        <Table
                                            class="teamMemberTable"
                                            id="teamMemberTableID"
                                            items="{
                                                path: 'selectedProject>/members'
                                            }"
                                        >
                                            <!-- Table Header for tools and filters -->
                                            <headerToolbar>
                                                <OverflowToolbar
                                                    height="auto"
                                                    width="100%"
                                                >
                                                    <HBox
                                                        wrap="Wrap"
                                                        justifyContent="SpaceBetween"
                                                        width="100%"
                                                    >
                                                        <VBox>
                                                            <Title
                                                                text="Team Members"
                                                                level="H1"
                                                            />
                                                            <Text
                                                                text="Manage team members and their roles"
                                                            />
                                                        </VBox>

                                                        <Button
                                                            type="Emphasized"
                                                            icon="sap-icon://add"
                                                            text="Onboard Member"
                                                            press=".onHandleOnboardMember"
                                                            visible="{= ${currentUser>/roles/0}==='manager'}"
                                                        />
                                                    </HBox>
                                                </OverflowToolbar>
                                            </headerToolbar>

                                            <!-- ColumNs Container -->
                                            <columns>
                                                <Column
                                                    demandPopin="true"
                                                    minScreenWidth="Phone"
                                                >
                                                    <Text text="Name" />
                                                </Column>

                                                <Column
                                                    demandPopin="true"
                                                    minScreenWidth="Phone"
                                                >
                                                    <Text text="Role" />
                                                </Column>

                                                <Column
                                                    visible="false"
                                                    demandPopin="true"
                                                    minScreenWidth="Phone"
                                                >
                                                    <Text text="Tasks" />
                                                </Column>

                                                <Column
                                                    demandPopin="true"
                                                    minScreenWidth="Phone"
                                                >
                                                    <Text text="Status" />
                                                </Column>

                                                <Column
                                                    demandPopin="true"
                                                    minScreenWidth="Phone"
                                                >
                                                    <Text text="Actions" />
                                                </Column>
                                            </columns>

                                            <!-- Table Data cells -->
                                            <items>
                                                <ColumnListItem
                                                    class="teamMemberTableColumnList"
                                                    counter="3"
                                                >
                                                    <cells>
                                                        <ObjectIdentifier
                                                            title="{selectedProject>user/firstname} {selectedProject>user/lastname}"
                                                            text="{selectedProject>user/email}"
                                                            
                                                        />

                                                        <Button
                                                            text="{selectedProject>user/role}"
                                                        />

                                                        <Text
                                                            visible="false"
                                                            text="8"
                                                        />

                                                        <ObjectStatus
                                                            inverted="true"
                                                            text="{= ${selectedProject>user/isActive}===true ? 'Online' : 'Offline'}"
                                                            state="{= ${selectedProject>user/isActive}===true ? 'Success' : 'Warning'}"
                                                        />

                                                        <OverflowToolbar>
                                                            <OverflowToolbarButton
                                                                tooltip="Discussion"
                                                                text="Discussion"
                                                                icon="sap-icon://comment"
                                                            />
                                                            <OverflowToolbarButton
                                                                tooltip="Delete"
                                                                text="Delete"
                                                                icon="sap-icon://delete"
                                                                type="Reject"
                                                                press="onHandleDeleteMember"
                                                                visible="{= ${currentUser>/roles/0}==='manager' }"
                                                            />
                                                        </OverflowToolbar>
                                                    </cells>
                                                </ColumnListItem>
                                            </items>
                                        </Table>
                                    </HBox>
                                </IconTabFilter>

                                <!-- TO BE IMPLEMENTED || Need To Add Chats Regarding the Project Discussion -->
                                <IconTabFilter
                                    text="Discussions"
                                    icon="sap-icon://discussion-2"
                                    design="Vertical"
                                >
                                    <BusyIndicator text="FEATURE COMING SOON" />
                                </IconTabFilter>
                                <!-- TO BE IMPLEMENTED || Need to add Analytical Data -->
                                <IconTabFilter
                                    text="Analytics"
                                    icon="sap-icon://compare"
                                    design="Vertical"
                                >
                                    <BusyIndicator text="FEATURE COMING SOON" />
                                </IconTabFilter>
                            </items>
                        </IconTabBar>
                    </HBox>
                </VBox>
            </Page>
        </detailPages>
    </SplitApp>
</mvc:View>
